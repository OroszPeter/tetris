import{s as ce,n as G,o as ue}from"../chunks/B2QSKqcC.js";import{S as fe,i as ie,d as g,y as K,s as W,z as Y,b as T,c as y,A as ae,w as O,e as I,f as q,g as U,h as z,j as A,k as Z,l as J,o as L,B as X,x as E,q as me,t as de,a as _e,u as pe,v as ge,r as ve}from"../chunks/DGBV0rNl.js";function R(s){return(s==null?void 0:s.length)!==void 0?s:Array.from(s)}function F(s,l,e){const t=s.slice();return t[21]=l[e],t[23]=e,t}function Q(s,l,e){const t=s.slice();return t[24]=l[e],t[26]=e,t}function x(s,l,e){const t=s.slice();return t[21]=l[e],t[23]=e,t}function $(s,l,e){const t=s.slice();return t[24]=l[e],t[26]=e,t}function ee(s){let l;return{c(){l=A("div"),this.h()},l(e){l=I(e,"DIV",{class:!0,style:!0});var t=q(l);t.forEach(g),this.h()},h(){O(l,"class","cell svelte-1haqnhp"),E(l,"background-color",s[24]?s[8][Object.keys(s[7])[s[24]-1]]:"#000"),E(l,"left",s[26]*C+"px"),E(l,"top",s[23]*C+"px")},m(e,t){T(e,l,t)},p(e,t){t&1&&E(l,"background-color",e[24]?e[8][Object.keys(e[7])[e[24]-1]]:"#000")},d(e){e&&g(l)}}}function te(s){let l,e=R(s[21]),t=[];for(let n=0;n<e.length;n+=1)t[n]=ee($(s,e,n));return{c(){for(let n=0;n<t.length;n+=1)t[n].c();l=L()},l(n){for(let r=0;r<t.length;r+=1)t[r].l(n);l=L()},m(n,r){for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(n,r);T(n,l,r)},p(n,r){if(r&385){e=R(n[21]);let o;for(o=0;o<e.length;o+=1){const u=$(n,e,o);t[o]?t[o].p(u,r):(t[o]=ee(u),t[o].c(),t[o].m(l.parentNode,l))}for(;o<t.length;o+=1)t[o].d(1);t.length=e.length}},d(n){n&&g(l),K(t,n)}}}function le(s){let l,e=R(s[1]),t=[];for(let n=0;n<e.length;n+=1)t[n]=se(F(s,e,n));return{c(){for(let n=0;n<t.length;n+=1)t[n].c();l=L()},l(n){for(let r=0;r<t.length;r+=1)t[r].l(n);l=L()},m(n,r){for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(n,r);T(n,l,r)},p(n,r){if(r&270){e=R(n[1]);let o;for(o=0;o<e.length;o+=1){const u=F(n,e,o);t[o]?t[o].p(u,r):(t[o]=se(u),t[o].c(),t[o].m(l.parentNode,l))}for(;o<t.length;o+=1)t[o].d(1);t.length=e.length}},d(n){n&&g(l),K(t,n)}}}function ne(s){let l;return{c(){l=A("div"),this.h()},l(e){l=I(e,"DIV",{class:!0,style:!0});var t=q(l);t.forEach(g),this.h()},h(){O(l,"class","cell piece svelte-1haqnhp"),E(l,"background-color",s[8][s[2]]),E(l,"left",(s[3].x+s[26])*C+"px"),E(l,"top",(s[3].y+s[23])*C+"px")},m(e,t){T(e,l,t)},p(e,t){t&4&&E(l,"background-color",e[8][e[2]]),t&8&&E(l,"left",(e[3].x+e[26])*C+"px"),t&8&&E(l,"top",(e[3].y+e[23])*C+"px")},d(e){e&&g(l)}}}function oe(s){let l,e=s[24]&&ne(s);return{c(){e&&e.c(),l=L()},l(t){e&&e.l(t),l=L()},m(t,n){e&&e.m(t,n),T(t,l,n)},p(t,n){t[24]?e?e.p(t,n):(e=ne(t),e.c(),e.m(l.parentNode,l)):e&&(e.d(1),e=null)},d(t){t&&g(l),e&&e.d(t)}}}function se(s){let l,e=R(s[21]),t=[];for(let n=0;n<e.length;n+=1)t[n]=oe(Q(s,e,n));return{c(){for(let n=0;n<t.length;n+=1)t[n].c();l=L()},l(n){for(let r=0;r<t.length;r+=1)t[r].l(n);l=L()},m(n,r){for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(n,r);T(n,l,r)},p(n,r){if(r&270){e=R(n[21]);let o;for(o=0;o<e.length;o+=1){const u=Q(n,e,o);t[o]?t[o].p(u,r):(t[o]=oe(u),t[o].c(),t[o].m(l.parentNode,l))}for(;o<t.length;o+=1)t[o].d(1);t.length=e.length}},d(n){n&&g(l),K(t,n)}}}function re(s){let l,e,t="Játék Vége",n,r,o="Új Játék",u,a;return{c(){l=A("div"),e=A("h2"),e.textContent=t,n=J(),r=A("button"),r.textContent=o,this.h()},l(v){l=I(v,"DIV",{class:!0});var b=q(l);e=I(b,"H2",{"data-svelte-h":!0}),X(e)!=="svelte-1iqq36i"&&(e.textContent=t),n=z(b),r=I(b,"BUTTON",{class:!0,"data-svelte-h":!0}),X(r)!=="svelte-19amto1"&&(r.textContent=o),b.forEach(g),this.h()},h(){O(r,"class","svelte-1haqnhp"),O(l,"class","game-over svelte-1haqnhp")},m(v,b){T(v,l,b),y(l,e),y(l,n),y(l,r),u||(a=ae(r,"click",s[9]),u=!0)},p:G,d(v){v&&g(l),u=!1,a()}}}function be(s){let l,e,t,n,r,o,u,a,v,b,d,D,P,M,N,S=R(s[0]),m=[];for(let f=0;f<S.length;f+=1)m[f]=te(x(s,S,f));let _=s[1]&&le(s),p=s[4]&&re(s);return{c(){l=A("div"),e=A("div"),t=A("div"),n=Z("Pontszám: "),r=Z(s[5]),o=J(),u=A("div"),a=Z("Rekord: "),v=Z(s[6]),b=J(),d=A("div");for(let f=0;f<m.length;f+=1)m[f].c();D=J(),_&&_.c(),P=J(),p&&p.c(),this.h()},l(f){l=I(f,"DIV",{class:!0});var k=q(l);e=I(k,"DIV",{class:!0});var h=q(e);t=I(h,"DIV",{class:!0});var V=q(t);n=U(V,"Pontszám: "),r=U(V,s[5]),V.forEach(g),o=z(h),u=I(h,"DIV",{class:!0});var c=q(u);a=U(c,"Rekord: "),v=U(c,s[6]),c.forEach(g),h.forEach(g),b=z(k),d=I(k,"DIV",{class:!0});var i=q(d);for(let w=0;w<m.length;w+=1)m[w].l(i);D=z(i),_&&_.l(i),P=z(i),p&&p.l(i),i.forEach(g),k.forEach(g),this.h()},h(){O(t,"class","score"),O(u,"class","high-score"),O(e,"class","score-container svelte-1haqnhp"),O(d,"class","game-board svelte-1haqnhp"),Y(d,"game-over",s[4]),O(l,"class","game-container svelte-1haqnhp")},m(f,k){T(f,l,k),y(l,e),y(e,t),y(t,n),y(t,r),y(e,o),y(e,u),y(u,a),y(u,v),y(l,b),y(l,d);for(let h=0;h<m.length;h+=1)m[h]&&m[h].m(d,null);y(d,D),_&&_.m(d,null),y(d,P),p&&p.m(d,null),M||(N=ae(window,"keydown",s[10]),M=!0)},p(f,[k]){if(k&32&&W(r,f[5]),k&64&&W(v,f[6]),k&385){S=R(f[0]);let h;for(h=0;h<S.length;h+=1){const V=x(f,S,h);m[h]?m[h].p(V,k):(m[h]=te(V),m[h].c(),m[h].m(d,D))}for(;h<m.length;h+=1)m[h].d(1);m.length=S.length}f[1]?_?_.p(f,k):(_=le(f),_.c(),_.m(d,P)):_&&(_.d(1),_=null),f[4]?p?p.p(f,k):(p=re(f),p.c(),p.m(d,null)):p&&(p.d(1),p=null),k&16&&Y(d,"game-over",f[4])},i:G,o:G,d(f){f&&g(l),K(m,f),_&&_.d(),p&&p.d(),M=!1,N()}}}const H=10,B=20,C=30;function ke(s,l,e){const t=H*C,n=B*C;let r=Array(B).fill().map(()=>Array(H).fill(0)),o=null,u=null,a={x:0,y:0},v=!1,b=0,d=0,D;const P={I:[[0,0,0,0],[1,1,1,1],[0,0,0,0],[0,0,0,0]],O:[[1,1],[1,1]],T:[[0,1,0],[1,1,1],[0,0,0]],S:[[0,1,1],[1,1,0],[0,0,0]],Z:[[1,1,0],[0,1,1],[0,0,0]],J:[[1,0,0],[1,1,1],[0,0,0]],L:[[0,0,1],[1,1,1],[0,0,0]]},M={I:"#00f0f0",O:"#f0f000",T:"#a000f0",S:"#00f000",Z:"#f00000",J:"#0000f0",L:"#f0a000"};ue(()=>(e(6,d=localStorage.getItem("tetrisHighScore")||0),N(),document.documentElement.style.setProperty("--board-width",`${t}px`),document.documentElement.style.setProperty("--board-height",`${n}px`),document.documentElement.style.setProperty("--block-size",`${C}px`),()=>{D&&clearInterval(D)}));function N(){e(0,r=Array(B).fill().map(()=>Array(H).fill(0))),e(5,b=0),e(4,v=!1),S(),D=setInterval(f,1e3)}function S(){const c=Object.keys(P),i=c[Math.floor(Math.random()*c.length)];e(2,u=i),e(1,o=P[i]),e(3,a={x:Math.floor(H/2)-Math.floor(o[0].length/2),y:0}),m()&&(e(4,v=!0),clearInterval(D),b>d&&(e(6,d=b),localStorage.setItem("tetrisHighScore",d)))}function m(){for(let c=0;c<o.length;c++)for(let i=0;i<o[c].length;i++)if(o[c][i]){const w=a.x+i,j=a.y+c;if(w<0||w>=H||j>=B||j>=0&&r[j][w])return!0}return!1}function _(){for(let c=0;c<o.length;c++)for(let i=0;i<o[c].length;i++)if(o[c][i]){const w=a.y+c;w>=0&&e(0,r[w][a.x+i]=Object.keys(P).indexOf(u)+1,r)}}function p(){let c=0;for(let i=B-1;i>=0;i--)r[i].every(w=>w)&&(r.splice(i,1),r.unshift(Array(H).fill(0)),c++,i++);e(5,b+=c*100)}function f(){v||(e(3,a.y++,a),m()&&(e(3,a.y--,a),_(),p(),S()))}function k(){if(v)return;const c=o[0].map((w,j)=>o.map(he=>he[j]).reverse()),i=o;e(1,o=c),m()&&e(1,o=i)}function h(c){v||(e(3,a.x+=c,a),m()&&e(3,a.x-=c,a))}function V(c){switch(["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(c.key)&&c.preventDefault(),c.key){case"ArrowLeft":h(-1);break;case"ArrowRight":h(1);break;case"ArrowDown":e(3,a.y++,a),m()&&e(3,a.y--,a);break;case"ArrowUp":k();break}}return[r,o,u,a,v,b,d,P,M,N,V]}class ye extends fe{constructor(l){super(),ie(this,l,ke,be,ce,{})}}function we(s){let l,e,t;return e=new ye({}),{c(){l=A("main"),ve(e.$$.fragment),this.h()},l(n){l=I(n,"MAIN",{class:!0});var r=q(l);ge(e.$$.fragment,r),r.forEach(g),this.h()},h(){O(l,"class","svelte-1u1w95")},m(n,r){T(n,l,r),pe(e,l,null),t=!0},p:G,i(n){t||(_e(e.$$.fragment,n),t=!0)},o(n){de(e.$$.fragment,n),t=!1},d(n){n&&g(l),me(e)}}}class Ee extends fe{constructor(l){super(),ie(this,l,null,we,ce,{})}}export{Ee as component};
